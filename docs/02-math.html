<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Mathematical preliminaries | Quantitative Methods for Geographers</title>
  <meta name="description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Mathematical preliminaries | Quantitative Methods for Geographers" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  <meta name="github-repo" content="krueger-t/qm4g" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Mathematical preliminaries | Quantitative Methods for Geographers" />
  
  <meta name="twitter:description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  

<meta name="author" content="Tobias Krueger" />


<meta name="date" content="2024-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="03-lin_reg.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding/rglWebGL.js"></script>
<link href="libs/rglwidgetClass/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass/rglClass.src.js"></script>
<script src="libs/rglwidgetClass/utils.src.js"></script>
<script src="libs/rglwidgetClass/buffer.src.js"></script>
<script src="libs/rglwidgetClass/subscenes.src.js"></script>
<script src="libs/rglwidgetClass/shaders.src.js"></script>
<script src="libs/rglwidgetClass/textures.src.js"></script>
<script src="libs/rglwidgetClass/projection.src.js"></script>
<script src="libs/rglwidgetClass/mouse.src.js"></script>
<script src="libs/rglwidgetClass/init.src.js"></script>
<script src="libs/rglwidgetClass/pieces.src.js"></script>
<script src="libs/rglwidgetClass/draw.src.js"></script>
<script src="libs/rglwidgetClass/controls.src.js"></script>
<script src="libs/rglwidgetClass/selection.src.js"></script>
<script src="libs/rglwidgetClass/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass/pretty.src.js"></script>
<script src="libs/rglwidgetClass/axes.src.js"></script>
<script src="libs/rglwidgetClass/animation.src.js"></script>
<!--html_preserve--><script type = "text/plain" id = "rgl-vertex-shader">
#line 2 1
// File 1 is the vertex shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif

attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;

#ifdef NEEDS_VNORMAL
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec4 vNormal;
#endif

#if defined(HAS_TEXTURE) || defined (IS_TEXT)
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
#endif

#ifdef FIXED_SIZE
uniform vec3 textScale;
#endif

#ifdef FIXED_QUADS
attribute vec3 aOfs;
#endif

#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
varying float normz;
uniform mat4 invPrMatrix;
#else
attribute vec3 aPos1;
attribute vec3 aPos2;
varying float normz;
#endif
#endif // IS_TWOSIDED

#ifdef FAT_LINES
attribute vec3 aNext;
attribute vec2 aPoint;
varying vec2 vPoint;
varying float vLength;
uniform float uAspect;
uniform float uLwd;
#endif


void main(void) {
  
#ifndef IS_BRUSH
#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
  vPosition = mvMatrix * vec4(aPos, 1.);
#endif
  
#ifndef FIXED_QUADS
  gl_Position = prMatrix * vPosition;
#endif
#endif // !IS_BRUSH
  
#ifdef IS_POINTS
  gl_PointSize = POINTSIZE;
#endif
  
  vCol = aCol;
  
#ifdef NEEDS_VNORMAL
  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
#endif
  
#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
  /* normz should be calculated *after* projection */
  normz = (invPrMatrix*vNormal).z;
#else
  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
  normz = pos1.x*pos2.y - pos1.y*pos2.x;
#endif
#endif // IS_TWOSIDED
  
#ifdef NEEDS_VNORMAL
  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
#endif
  
#if defined(HAS_TEXTURE) || defined(IS_TEXT)
  vTexcoord = aTexcoord;
#endif
  
#if defined(FIXED_SIZE) && !defined(ROTATING)
  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w;
  gl_Position = pos + vec4(aOfs*textScale, 0.);
#endif
  
#if defined(IS_SPRITES) && !defined(FIXED_SIZE)
  vec4 pos = mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w + vec4(aOfs,  0.);
  gl_Position = prMatrix*pos;
#endif
  
#ifdef FAT_LINES
  /* This code was inspired by Matt Deslauriers' code in 
   https://mattdesl.svbtle.com/drawing-lines-is-hard */
  vec2 aspectVec = vec2(uAspect, 1.0);
  mat4 projViewModel = prMatrix * mvMatrix;
  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
  currentProjected = currentProjected/currentProjected.w;
  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
  vec2 currentScreen = currentProjected.xy * aspectVec;
  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
  float len = uLwd;
  vec2 dir = vec2(1.0, 0.0);
  vPoint = aPoint;
  vLength = length(nextScreen - currentScreen)/2.0;
  vLength = vLength/(vLength + len);
  if (vLength > 0.0) {
    dir = normalize(nextScreen - currentScreen);
  }
  vec2 normal = vec2(-dir.y, dir.x);
  dir.x /= uAspect;
  normal.x /= uAspect;
  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
  gl_Position = currentProjected + offset;
#endif
  
#ifdef IS_BRUSH
  gl_Position = vec4(aPos, 1.);
#endif
}
</script>
<script type = "text/plain" id = "rgl-fragment-shader">
#line 2 2
// File 2 is the fragment shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
#if defined(HAS_TEXTURE) || defined (IS_TEXT)
varying vec2 vTexcoord;
uniform sampler2D uSampler;
#endif

#ifdef HAS_FOG
uniform int uFogMode;
uniform vec3 uFogColor;
uniform vec4 uFogParms;
#endif

#if defined(IS_LIT) && !defined(FIXED_QUADS)
varying vec4 vNormal;
#endif

#if NCLIPPLANES > 0
uniform vec4 vClipplane[NCLIPPLANES];
#endif

#if NLIGHTS > 0
uniform mat4 mvMatrix;
#endif

#ifdef IS_LIT
uniform vec3 emission;
uniform float shininess;
#if NLIGHTS > 0
uniform vec3 ambient[NLIGHTS];
uniform vec3 specular[NLIGHTS]; // light*material
uniform vec3 diffuse[NLIGHTS];
uniform vec3 lightDir[NLIGHTS];
uniform bool viewpoint[NLIGHTS];
uniform bool finite[NLIGHTS];
#endif
#endif // IS_LIT

#ifdef IS_TWOSIDED
uniform bool front;
varying float normz;
#endif

#ifdef FAT_LINES
varying vec2 vPoint;
varying float vLength;
#endif

void main(void) {
  vec4 fragColor;
#ifdef FAT_LINES
  vec2 point = vPoint;
  bool neg = point.y < 0.0;
  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                 -(point.y - vLength)/(1.0 - vLength);
#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
  if (neg && length(point) <= 1.0) discard;
#endif
  point.y = min(point.y, 0.0);
  if (length(point) > 1.0) discard;
#endif // FAT_LINES
  
#ifdef ROUND_POINTS
  vec2 coord = gl_PointCoord - vec2(0.5);
  if (length(coord) > 0.5) discard;
#endif
  
#if NCLIPPLANES > 0
  for (int i = 0; i < NCLIPPLANES; i++)
    if (dot(vPosition, vClipplane[i]) < 0.0) discard;
#endif
    
#ifdef FIXED_QUADS
    vec3 n = vec3(0., 0., 1.);
#elif defined(IS_LIT)
    vec3 n = normalize(vNormal.xyz);
#endif
    
#ifdef IS_TWOSIDED
    if ((normz <= 0.) != front) discard;
#endif
    
#ifdef IS_LIT
    vec3 eye = normalize(-vPosition.xyz/vPosition.w);
    vec3 lightdir;
    vec4 colDiff;
    vec3 halfVec;
    vec4 lighteffect = vec4(emission, 0.);
    vec3 col;
    float nDotL;
#ifdef FIXED_QUADS
    n = -faceforward(n, n, eye);
#endif
    
#if NLIGHTS > 0
    for (int i=0;i<NLIGHTS;i++) {
      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
      lightdir = lightDir[i];
      if (!viewpoint[i])
        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
      if (!finite[i]) {
        halfVec = normalize(lightdir + eye);
      } else {
        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
        halfVec = normalize(lightdir + eye);
      }
      col = ambient[i];
      nDotL = dot(n, lightdir);
      col = col + max(nDotL, 0.) * colDiff.rgb;
      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
      lighteffect = lighteffect + vec4(col, colDiff.a);
    }
#endif
    
#else // not IS_LIT
    vec4 colDiff = vCol;
    vec4 lighteffect = colDiff;
#endif
    
#ifdef IS_TEXT
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef HAS_TEXTURE
#ifdef TEXTURE_rgb
    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
#endif
    
#ifdef TEXTURE_rgba
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef TEXTURE_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
#endif
    
#ifdef TEXTURE_luminance
    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
#endif
    
#ifdef TEXTURE_luminance_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
#endif
    
    fragColor = textureColor;

#elif defined(IS_TEXT)
    if (textureColor.a < 0.1)
      discard;
    else
      fragColor = textureColor;
#else
    fragColor = lighteffect;
#endif // HAS_TEXTURE
    
#ifdef HAS_FOG
    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
    // In Exp and Exp2: use density = density/far
    // fogF will be the proportion of fog
    // Initialize it to the linear value
    float fogF;
    if (uFogMode > 0) {
      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
      if (uFogMode > 1)
        fogF = mix(uFogParms.w, 1.0, fogF);
      fogF = fogF*uFogParms.z;
      if (uFogMode == 2)
        fogF = 1.0 - exp(-fogF);
      // Docs are wrong: use (density*c)^2, not density*c^2
      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
      else if (uFogMode == 3)
        fogF = 1.0 - exp(-fogF*fogF);
      fogF = clamp(fogF, 0.0, 1.0);
      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
    } else gl_FragColor = fragColor;
#else
    gl_FragColor = fragColor;
#endif // HAS_FOG
    
}
</script><!--/html_preserve-->
<script src="libs/CanvasMatrix4/CanvasMatrix.src.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />
<link href="libs/bsTable/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Methods for Geographers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="02-math.html"><a href="02-math.html"><i class="fa fa-check"></i><b>1</b> Mathematical preliminaries</a></li>
<li class="chapter" data-level="2" data-path="03-lin_reg.html"><a href="03-lin_reg.html"><i class="fa fa-check"></i><b>2</b> Linear regression</a></li>
<li class="chapter" data-level="3" data-path="04-categorical_vars.html"><a href="04-categorical_vars.html"><i class="fa fa-check"></i><b>3</b> Categorical predictors</a></li>
<li class="chapter" data-level="4" data-path="05-multiple_lin_reg.html"><a href="05-multiple_lin_reg.html"><i class="fa fa-check"></i><b>4</b> Multiple linear regression</a></li>
<li class="chapter" data-level="5" data-path="06-ml_bayes.html"><a href="06-ml_bayes.html"><i class="fa fa-check"></i><b>5</b> Probabilistic underpinnings</a></li>
<li class="chapter" data-level="6" data-path="07-glms.html"><a href="07-glms.html"><i class="fa fa-check"></i><b>6</b> Generalised Linear Models (GLMs)</a></li>
<li class="chapter" data-level="7" data-path="08-multivariate.html"><a href="08-multivariate.html"><i class="fa fa-check"></i><b>7</b> Multivariate methods</a></li>
<li class="chapter" data-level="" data-path="09-solutions.html"><a href="09-solutions.html"><i class="fa fa-check"></i>Solutions to exercises</a></li>
<li class="chapter" data-level="" data-path="10-refs.html"><a href="10-refs.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Methods for Geographers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="math" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Mathematical preliminaries<a href="02-math.html#math" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we get a few mathematical preliminaries out of the way that are important for later chapters. If you feel rusty on any of these then please read up on them elsewhere.</p>
<div id="logarithm-and-exponentiation" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Logarithm and exponentiation<a href="02-math.html#logarithm-and-exponentiation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following is inspired by <span class="citation">Gelman and Nolan (<a href="#ref-gelman2002">2002</a>)</span>. Suppose you have an amoeba that takes one hour to divide (Figure <a href="02-math.html#fig:amoeba">1.1</a>), and then the two amoebas each divide in one more hour, and so forth. What is the equation of the number of amoebas, <span class="math inline">\(y\)</span>, as a function of time, <span class="math inline">\(t\)</span> (in hours)?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:amoeba"></span>
<img src="figs/amoeba.jpg" alt="Amoeba dividing. Source: http://www.gutenberg.org/files/18451/18451-h/images/illus002.jpg." width="80%" />
<p class="caption">
Figure 1.1: Amoeba dividing. Source: <a href="http://www.gutenberg.org/files/18451/18451-h/images/illus002.jpg" class="uri">http://www.gutenberg.org/files/18451/18451-h/images/illus002.jpg</a>.
</p>
</div>
<p>The equation is:
<span class="math display" id="eq:exp">\[\begin{equation}
y=2^t
\tag{1.1}
\end{equation}\]</span>
This is an <strong>exponential function</strong> with <strong>base</strong> 2 and <strong>exponent</strong> <span class="math inline">\(t\)</span>. Figure <a href="02-math.html#fig:explog">1.2</a> shows two plots of this function. (Don’t worry, you will start to understand the R code better as you progress in the PC labs.)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="02-math.html#cb1-1" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb1-2"><a href="02-math.html#cb1-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>t</span>
<span id="cb1-3"><a href="02-math.html#cb1-3" tabindex="-1"></a><span class="fu">plot</span>(t, y, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">type =</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb1-4"><a href="02-math.html#cb1-4" tabindex="-1"></a><span class="fu">plot</span>(t, <span class="fu">log</span>(y), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">type =</span> <span class="st">&#39;b&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:explog"></span>
<img src="qm4g_files/figure-html/explog-1.png" alt="Left: Plot of Equation 2.1. Right: Plot of Equation 2.1 on logarithmic scale." width="50%" /><img src="qm4g_files/figure-html/explog-2.png" alt="Left: Plot of Equation 2.1. Right: Plot of Equation 2.1 on logarithmic scale." width="50%" />
<p class="caption">
Figure 1.2: Left: Plot of Equation 2.1. Right: Plot of Equation 2.1 on logarithmic scale.
</p>
</div>
<p>The inverse of the exponential function is the <strong>logarithmic function</strong>:
<span class="math display" id="eq:inv">\[\begin{equation}
log(y)=log(2^t)=t \cdot log(2)
\tag{1.2}
\end{equation}\]</span>
Since the logarithm of <span class="math inline">\(y\)</span> is a linear function of <span class="math inline">\(t\)</span> (Equation <a href="02-math.html#eq:inv">(1.2)</a>), the right-hand side of Figure <a href="02-math.html#fig:explog">1.2</a> (<span class="math inline">\(y\)</span> on logarithmic scale) displays a straight line.</p>
<p>Common bases of the logarithmic function are:
<span class="math display" id="eq:lb">\[\begin{equation}
log_2\left(2^t\right)=lb\left(2^t\right)=t
\tag{1.3}
\end{equation}\]</span>
This is called the binary logarithm (lb).</p>
<p><span class="math display" id="eq:lg">\[\begin{equation}
log_{10}\left(10^t\right)=lg\left(10^t\right)=t
\tag{1.4}
\end{equation}\]</span>
This is called the common logarithm (lg).</p>
<p><span class="math display" id="eq:ln">\[\begin{equation}
log_e\left(e^t\right)=ln\left(e^t\right)=t
\tag{1.5}
\end{equation}\]</span>
This is called the natural logarithm (ln) with <span class="math inline">\(e \approx 2.7183\)</span> being Euler’s constant.</p>
<p>Note, programming often uses a different notation, which will also be used from now on in this course:
<span class="math display" id="eq:lnlog">\[\begin{equation}
ln()=log()
\tag{1.6}
\end{equation}\]</span>
<span class="math display" id="eq:eexp">\[\begin{equation}
e^t=\exp(t)
\tag{1.7}
\end{equation}\]</span></p>
<p>Basic rules for exponentiation are:
<span class="math display" id="eq:exprule1">\[\begin{equation}
a^m \cdot a^n=a^{m+n}
\tag{1.8}
\end{equation}\]</span>
<span class="math display" id="eq:exprule2">\[\begin{equation}
a^n \cdot b^n=(a \cdot b)^n
\tag{1.9}
\end{equation}\]</span>
<span class="math display" id="eq:exprule3">\[\begin{equation}
\frac{a^m}{a^n}=a^{m-n}
\tag{1.10}
\end{equation}\]</span>
<span class="math display" id="eq:exprule4">\[\begin{equation}
\frac{a^n}{b^n}=\left(\frac{a}{b}\right)^n
\tag{1.11}
\end{equation}\]</span>
<span class="math display" id="eq:exprule5">\[\begin{equation}
\left(a^m\right)^n=a^{m \cdot n}
\tag{1.12}
\end{equation}\]</span></p>
<p>At this point it is also useful to remind ourselves of the meaning of the sum and product symbols:
<span class="math display" id="eq:sum">\[\begin{equation}
\sum_{i=1}^{n}x_i=x_1+x_2+\ldots+x_n
\tag{1.13}
\end{equation}\]</span>
This signifies the <strong>sum</strong> of all <span class="math inline">\(x_i\)</span> for <span class="math inline">\(i\)</span> taking integer values from 1 to <span class="math inline">\(n\)</span>.
<span class="math display" id="eq:prod">\[\begin{equation}
\prod_{i=1}^{n}x_i=x_1 \cdot x_2 \cdot \ldots \cdot x_n
\tag{1.14}
\end{equation}\]</span>
This signifies the <strong>product</strong> of all <span class="math inline">\(x_i\)</span> for <span class="math inline">\(i\)</span> taking integer values from 1 to <span class="math inline">\(n\)</span>.</p>
<p>The basic rules of logarithm are:
<span class="math display" id="eq:logrule1">\[\begin{equation}
log(u \cdot v)=log(u)+log(v)
\tag{1.15}
\end{equation}\]</span>
<span class="math display" id="eq:logrule2">\[\begin{equation}
log\left(\frac{u}{v}\right)=log(u)-log(v)
\tag{1.16}
\end{equation}\]</span>
<span class="math display" id="eq:logrule3">\[\begin{equation}
log\left(u^r\right)=r \cdot log(u)
\tag{1.17}
\end{equation}\]</span></p>
</div>
<div id="centring-and-standardisation" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Centring and standardisation<a href="02-math.html#centring-and-standardisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Centring and standardisation are used to transform different datasets onto the same scale. We will need this for the multivariate methods in later sessions (Chapter <a href="08-multivariate.html#multivariate">7</a>) or when comparing the effects of different predictors on a response variable (Chapter <a href="05-multiple_lin_reg.html#multiplelinreg">4</a>).</p>
<p><strong>Centring</strong> means subtracting from every data point <span class="math inline">\(y\)</span> the overall mean of the data <span class="math inline">\(\bar{y}\)</span>:
<span class="math display" id="eq:centring">\[\begin{equation}
y^*=y-\bar{y}
\tag{1.18}
\end{equation}\]</span>
This yields new data points <span class="math inline">\(y^*\)</span> and a new mean <span class="math inline">\(\bar{y^*}=0\)</span> while the standard deviation of the transformed data remains the same: <span class="math inline">\(s_{y^*}=s_y\)</span>. Centring thus <em>shifts</em> the data histogram to be centred on zero, but does not change its shape (Figure <a href="02-math.html#fig:rawcentred">1.3</a>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="02-math.html#cb2-1" tabindex="-1"></a><span class="co"># draw random sample of size 1000 from normal distribution with mean 1 and standard deviation 2, i.e. y~N(1,2)</span></span>
<span id="cb2-2"><a href="02-math.html#cb2-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb2-3"><a href="02-math.html#cb2-3" tabindex="-1"></a><span class="co"># mean</span></span>
<span id="cb2-4"><a href="02-math.html#cb2-4" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb2-5"><a href="02-math.html#cb2-5" tabindex="-1"></a><span class="co"># standard deviation</span></span>
<span id="cb2-6"><a href="02-math.html#cb2-6" tabindex="-1"></a>s_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(y)</span>
<span id="cb2-7"><a href="02-math.html#cb2-7" tabindex="-1"></a><span class="co"># histogram, raw</span></span>
<span id="cb2-8"><a href="02-math.html#cb2-8" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb2-9"><a href="02-math.html#cb2-9" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;relative frequency&quot;</span>)</span>
<span id="cb2-10"><a href="02-math.html#cb2-10" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(ybar, ybar), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb2-11"><a href="02-math.html#cb2-11" tabindex="-1"></a><span class="co"># histogram, centred</span></span>
<span id="cb2-12"><a href="02-math.html#cb2-12" tabindex="-1"></a><span class="fu">hist</span>(y<span class="sc">-</span>ybar, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb2-13"><a href="02-math.html#cb2-13" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y*&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;relative frequency&quot;</span>)</span>
<span id="cb2-14"><a href="02-math.html#cb2-14" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rawcentred"></span>
<img src="qm4g_files/figure-html/rawcentred-1.png" alt="Histogram of data $y$ (left) and centred data $y^*$ (right). The vertical line represents the mean." width="50%" /><img src="qm4g_files/figure-html/rawcentred-2.png" alt="Histogram of data $y$ (left) and centred data $y^*$ (right). The vertical line represents the mean." width="50%" />
<p class="caption">
Figure 1.3: Histogram of data <span class="math inline">\(y\)</span> (left) and centred data <span class="math inline">\(y^*\)</span> (right). The vertical line represents the mean.
</p>
</div>
<p><strong>Standardisation</strong> means subtracting from every data point <span class="math inline">\(y\)</span> the overall mean of the data <span class="math inline">\(\bar{y}\)</span> and additionally dividing by the standard deviation <span class="math inline">\(s_y\)</span>:
<span class="math display" id="eq:standardisation">\[\begin{equation}
y^*=\frac{y-\bar{y}}{s_y}
\tag{1.19}
\end{equation}\]</span>
This yields new data points <span class="math inline">\(y^*\)</span>, a new mean <span class="math inline">\(\bar{y^*}=0\)</span> and a new standard deviation <span class="math inline">\(s_{y^*}=1\)</span>. Standardisation thus shifts the data histogram to be centred on zero and expands or contracts it to have unit standard deviation (Figure <a href="02-math.html#fig:rawstandardised">1.4</a>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="02-math.html#cb3-1" tabindex="-1"></a><span class="co"># histogram, raw</span></span>
<span id="cb3-2"><a href="02-math.html#cb3-2" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb3-3"><a href="02-math.html#cb3-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;relative frequency&quot;</span>)</span>
<span id="cb3-4"><a href="02-math.html#cb3-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(ybar, ybar), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb3-5"><a href="02-math.html#cb3-5" tabindex="-1"></a><span class="co"># histogram, standardised</span></span>
<span id="cb3-6"><a href="02-math.html#cb3-6" tabindex="-1"></a><span class="fu">hist</span>((y<span class="sc">-</span>ybar)<span class="sc">/</span>s_y, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb3-7"><a href="02-math.html#cb3-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;y*&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;relative frequency&quot;</span>)</span>
<span id="cb3-8"><a href="02-math.html#cb3-8" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rawstandardised"></span>
<img src="qm4g_files/figure-html/rawstandardised-1.png" alt="Histogram of data $y$ (left) and standardised data $y^*$ (right). The vertical line represents the mean." width="50%" /><img src="qm4g_files/figure-html/rawstandardised-2.png" alt="Histogram of data $y$ (left) and standardised data $y^*$ (right). The vertical line represents the mean." width="50%" />
<p class="caption">
Figure 1.4: Histogram of data <span class="math inline">\(y\)</span> (left) and standardised data <span class="math inline">\(y^*\)</span> (right). The vertical line represents the mean.
</p>
</div>
<p>If the original data <span class="math inline">\(y\)</span> were normally distributed (like we set it up for the plots above) then standardisation would transform <span class="math inline">\(y\)</span> to the scale of the standard normal distribution, i.e. a normal distribution with mean 0 and standard deviation 1. If you feel rusty on the normal distribution (or probability distributions in general) then Wikipedia is as good a source as any: <a href="https://en.wikipedia.org/wiki/Normal_distribution" class="uri">https://en.wikipedia.org/wiki/Normal_distribution</a>.</p>
</div>
<div id="derivatives" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Derivatives<a href="02-math.html#derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>first derivative</strong> of a function <span class="math inline">\(f(x)\)</span>, written as <span class="math inline">\(f&#39;(x)\)</span> or <span class="math inline">\(\frac{df(x)}{dx}\)</span>, can be interpreted graphically as the slope of that function, i.e. the tangent line of a certain point of the function (Figure <a href="02-math.html#fig:derivative">1.5</a>, left).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:derivative"></span>
<img src="qm4g_files/figure-html/derivative-1.png" alt="Left: Tangent line of function $f(x)$ at point $x_0$. Centre: Secant line of function $f(x)$ between point $x_0$ and point $x_0+h$; the horizontal distance between these two points is $\Delta x$ and the vertical distance is $\Delta f(x)$. Right: Set of secant lines of function $f(x)$ between point $x_0$ and point $x_0+h$ for progressively decreasing increments $h$." width="33%" /><img src="qm4g_files/figure-html/derivative-2.png" alt="Left: Tangent line of function $f(x)$ at point $x_0$. Centre: Secant line of function $f(x)$ between point $x_0$ and point $x_0+h$; the horizontal distance between these two points is $\Delta x$ and the vertical distance is $\Delta f(x)$. Right: Set of secant lines of function $f(x)$ between point $x_0$ and point $x_0+h$ for progressively decreasing increments $h$." width="33%" /><img src="qm4g_files/figure-html/derivative-3.png" alt="Left: Tangent line of function $f(x)$ at point $x_0$. Centre: Secant line of function $f(x)$ between point $x_0$ and point $x_0+h$; the horizontal distance between these two points is $\Delta x$ and the vertical distance is $\Delta f(x)$. Right: Set of secant lines of function $f(x)$ between point $x_0$ and point $x_0+h$ for progressively decreasing increments $h$." width="33%" />
<p class="caption">
Figure 1.5: Left: Tangent line of function <span class="math inline">\(f(x)\)</span> at point <span class="math inline">\(x_0\)</span>. Centre: Secant line of function <span class="math inline">\(f(x)\)</span> between point <span class="math inline">\(x_0\)</span> and point <span class="math inline">\(x_0+h\)</span>; the horizontal distance between these two points is <span class="math inline">\(\Delta x\)</span> and the vertical distance is <span class="math inline">\(\Delta f(x)\)</span>. Right: Set of secant lines of function <span class="math inline">\(f(x)\)</span> between point <span class="math inline">\(x_0\)</span> and point <span class="math inline">\(x_0+h\)</span> for progressively decreasing increments <span class="math inline">\(h\)</span>.
</p>
</div>
<p>Mathematically, the slope amounts to the limiting value of the ratio of the (vertical) increment of the function, <span class="math inline">\(\Delta f(x)\)</span>, and the (horizontal) increment of <span class="math inline">\(x\)</span>, <span class="math inline">\(\Delta x\)</span>, for <span class="math inline">\(\Delta x\)</span> approaching zero, i.e. <span class="math inline">\(\Delta x \to 0\)</span>:
<span class="math display" id="eq:derivative1">\[\begin{equation}
f&#39;(x)=\frac{df(x)}{dx}=\lim_{\Delta x \to 0}\frac{\Delta f(x)}{\Delta x}
\tag{1.20}
\end{equation}\]</span></p>
<p>This can be visualised as a secant line of the function between two points, <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_0+h\)</span> (Figure <a href="02-math.html#fig:derivative">1.5</a>, centre), whose slope is:
<span class="math display" id="eq:derivative2">\[\begin{equation}
\frac{\Delta f(x)}{\Delta x}=\frac{f\left(x_0+h\right)-f\left(x_0\right)}{\left(x_0+h\right)-\left(x_0\right)}=\frac{f\left(x_0+h\right)-f\left(x_0\right)}{h}
\tag{1.21}
\end{equation}\]</span></p>
<p>As <span class="math inline">\(h\)</span> approaches zero (Figure <a href="02-math.html#fig:derivative">1.5</a>, right) we reach the limiting value of the slope at point <span class="math inline">\(x_0\)</span>, which is the first derivative:
<span class="math display" id="eq:derivative3">\[\begin{equation}
\frac{df(x)}{dx}=\lim_{h \to 0}\frac{f\left(x_0+h\right)-f\left(x_0\right)}{h}
\tag{1.22}
\end{equation}\]</span></p>
<p>The first derivative is useful for finding <strong>minima</strong>, <strong>maxima</strong> and <strong>inflexion points</strong> of a function, because this is where the slope is zero, <span class="math inline">\(\frac{df(x)}{dx}=0\)</span> (Figure <a href="02-math.html#fig:minmax">1.6</a>). The <strong>second derivative</strong>, measuring the curvature of the function, tells us whether these points are minima <span class="math inline">\(\left(\frac{d^2f(x)}{dx^2}&gt;0\right)\)</span>, maxima <span class="math inline">\(\left(\frac{d^2f(x)}{dx^2}&lt;0\right)\)</span> or inflexion points <span class="math inline">\(\left(\frac{d^2f(x)}{dx^2}=0\right)\)</span>, but often we already know that a function has only a single minimum or maximum and then we do not need the second derivative.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:minmax"></span>
<img src="figs/derivative4.gif" alt="Use of first and second derivative to determine minima, maxima and inflexion points of a function. Source: http://hyperphysics.phy-astr.gsu.edu/hbase/math/maxmin.html." width="80%" />
<p class="caption">
Figure 1.6: Use of first and second derivative to determine minima, maxima and inflexion points of a function. Source: <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/math/maxmin.html" class="uri">http://hyperphysics.phy-astr.gsu.edu/hbase/math/maxmin.html</a>.
</p>
</div>
<p>The differentiation rules are listed below:</p>
<p>If <span class="math inline">\(y=f(t)=t^a\)</span> then <span class="math inline">\(\frac{dy}{dt}=a \cdot t^{a-1}\)</span>, i.e. multiplying the function with the exponent and reducing the exponent by one gives you the derivative of <span class="math inline">\(f(t)\)</span>.</p>
<p>Constant factor rule: If <span class="math inline">\(y=c \cdot u(t)\)</span> then <span class="math inline">\(\frac{dy}{dt}=c \cdot \frac{du}{dt}\)</span>.</p>
<p>Sum rule: If <span class="math inline">\(y=u(t) \pm v(t)\)</span> then <span class="math inline">\(\frac{dy}{dt}=\frac{du}{dt} \pm \frac{dv}{dt}\)</span>.</p>
<p>Product rule: If <span class="math inline">\(y=u(t) \cdot v(t)\)</span> then <span class="math inline">\(\frac{dy}{dt}=\frac{du}{dt} \cdot v+u \cdot \frac{dv}{dt}\)</span>.</p>
<p>Quotient rule: If <span class="math inline">\(y=\frac{u(t)}{v(t)}\)</span> then <span class="math inline">\(\frac{dy}{dt}=\frac{\left(\frac{du}{dt} \cdot v-u \cdot \frac{dv}{dt}\right)}{v^2}\)</span>.</p>
<p>Chain rule: If <span class="math inline">\(y=f[g(t)]\)</span> then <span class="math inline">\(\frac{dy}{dt}=\frac{df[g]}{dg} \cdot \frac{dg}{dt}\)</span>, i.e. “outer times inner derivative”.</p>
</div>
<div id="matrix-algebra" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Matrix algebra<a href="02-math.html#matrix-algebra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following is based on <span class="citation">Tabachnick and Fidell (<a href="#ref-tabachnick2013">2013</a>)</span>.</p>
<div id="simple-matrix-operations" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Simple matrix operations<a href="02-math.html#simple-matrix-operations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> be matrices:</p>
<p><span class="math display">\[\mathbf{A} =
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix} =
\begin{pmatrix}
3 &amp; 2 &amp; 4\\
7 &amp; 5 &amp; 0\\
1 &amp; 0 &amp; 8
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[\mathbf{B} =
\begin{pmatrix}
r &amp; s &amp; t\\
u &amp; v &amp; w\\
x &amp; y &amp; z
\end{pmatrix} =
\begin{pmatrix}
6 &amp; 1 &amp; 0\\
2 &amp; 8 &amp; 7\\
3 &amp; 4 &amp; 5
\end{pmatrix}
\]</span></p>
<p><strong>Addition/subtraction of a constant to a matrix</strong> happens element-wise:</p>
<p><span class="math display">\[\mathbf{A} + k =
\begin{pmatrix}
a+k &amp; b+k &amp; c+k\\
d+k &amp; e+k &amp; f+k\\
g+k &amp; h+k &amp; i+k
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[\mathbf{A} - k =
\begin{pmatrix}
a-k &amp; b-k &amp; c-k\\
d-k &amp; e-k &amp; f-k\\
g-k &amp; h-k &amp; i-k
\end{pmatrix}
\]</span></p>
<p><strong>Multiplication/division of a matrix by a constant</strong> also happens element-wise:</p>
<p><span class="math display">\[k \cdot \mathbf{A} =
\begin{pmatrix}
k \cdot a &amp; k \cdot b &amp; k \cdot c\\
k \cdot d &amp; k \cdot e &amp; k \cdot f\\
k \cdot g &amp; k \cdot h &amp; k \cdot i
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[\frac{1}{k} \cdot \mathbf{A} =
\begin{pmatrix}
\frac{1}{k} \cdot a &amp; \frac{1}{k} \cdot b &amp; \frac{1}{k} \cdot c\\
\frac{1}{k} \cdot d &amp; \frac{1}{k} \cdot e &amp; \frac{1}{k} \cdot f\\
\frac{1}{k} \cdot g &amp; \frac{1}{k} \cdot h &amp; \frac{1}{k} \cdot i
\end{pmatrix}
\]</span></p>
<p><strong>Addition/subtraction of two matrices</strong> happens element-wise again:</p>
<p><span class="math display">\[\mathbf{A} + \mathbf{B} =
\begin{pmatrix}
a+r &amp; b+s &amp; c+t\\
d+u &amp; e+v &amp; f+w\\
g+x &amp; h+y &amp; i+z
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[\mathbf{A} - \mathbf{B} =
\begin{pmatrix}
a-r &amp; b-s &amp; c-t\\
d-u &amp; e-v &amp; f-w\\
g-x &amp; h-y &amp; i-z
\end{pmatrix}
\]</span></p>
<p>Finally, the so called <strong>transpose of a matrix</strong> refers to the mirroring of a matrix along its diagonal. Hence, the transpose of <span class="math inline">\(\mathbf{A}\)</span> is:</p>
<p><span class="math display">\[\mathbf{A}&#39; =
\begin{pmatrix}
a &amp; d &amp; g\\
b &amp; e &amp; h\\
c &amp; f &amp; i
\end{pmatrix}
\]</span></p>
</div>
<div id="matrix-multiplication" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Matrix multiplication<a href="02-math.html#matrix-multiplication" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The multiplication of two matrices is the only operation that is a bit complicated at first. It may be best to consider an example to work out the rules:</p>
<p><span class="math display">\[\begin{eqnarray}
\mathbf{A} \cdot \mathbf{B}&amp;=&amp;
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix} \cdot
\begin{pmatrix}
r &amp; s &amp; t\\
u &amp; v &amp; w\\
x &amp; y &amp; z
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
a \cdot r + b \cdot u + c \cdot x &amp; a \cdot s + b \cdot v + c \cdot y &amp; a \cdot t + b \cdot w + c \cdot z\\
d \cdot r + e \cdot u + f \cdot x &amp; d \cdot s + e \cdot v + f \cdot y &amp; d \cdot t + e \cdot w + f \cdot z\\
g \cdot r + h \cdot u + i \cdot x &amp; g \cdot s + h \cdot v + i \cdot y &amp; g \cdot t + h \cdot w + i \cdot z
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
34 &amp; 35 &amp; 34\\
52 &amp; 47 &amp; 35\\
30 &amp; 33 &amp; 40
\end{pmatrix}
\end{eqnarray}\]</span></p>
<p>The result of a matrix multiplication has as many <em>rows</em> as the 1st matrix and as many <em>columns</em> as the 2nd. For this to work, the number of columns of the 1st matrix must match the number of rows of the 2nd matrix. In our example, this does not matter as the matrices are square, i.e. they have as many rows as columns.</p>
<p>To construct each cell of the results matrix, one row of the 1st matrix is combined with one column of the 2nd matrix. For cell (1,1) (top-left), for example, we combine the 1st row of matrix 1 (here <span class="math inline">\(\mathbf{A}\)</span>) and the 1st column of matrix 2 (here <span class="math inline">\(\mathbf{B}\)</span>). Moving to the right, for cell (1,2) (top-middle), we combine the 1st row of matrix 1 and the 2nd column of matrix 2. For cell (2,1) (middle-left), we combine the 2nd row of matrix 1 and the 1st column of matrix 2. And so on and so forth.</p>
<p>The combination of the two respective vectors is the sum of the products of the vector elements paired in order. So for cell (1,1) in our example this is <span class="math inline">\(a \cdot r + b \cdot u + c \cdot x\)</span>. Try and recreate the following example to get a feeling for the matrix multiplication rules.</p>
<p><span class="math display">\[\begin{eqnarray}
\mathbf{B} \cdot \mathbf{A}&amp;=&amp;
\begin{pmatrix}
r &amp; s &amp; t\\
u &amp; v &amp; w\\
x &amp; y &amp; z
\end{pmatrix} \cdot
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
r \cdot a + s \cdot d + t \cdot g &amp; r \cdot b + s \cdot e + t \cdot h &amp; r \cdot c + s \cdot f + t \cdot i\\
u \cdot a + v \cdot d + w \cdot g &amp; u \cdot b + v \cdot e + w \cdot h &amp; u \cdot c + v \cdot f + w \cdot i\\
x \cdot a + y \cdot d + z \cdot g &amp; x \cdot b + y \cdot e + z \cdot h &amp; x \cdot c + y \cdot f + z \cdot i
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
25 &amp; 17 &amp; 24\\
69 &amp; 44 &amp; 64\\
42 &amp; 26 &amp; 52
\end{pmatrix}
\end{eqnarray}\]</span></p>
<p>The point with this example is that <span class="math inline">\(\mathbf{A} \cdot \mathbf{B}\)</span> is not the same as <span class="math inline">\(\mathbf{B} \cdot \mathbf{A}\)</span>. The order matters when multiplying matrices! Let’s consider two more example:</p>
<p><span class="math display">\[\begin{eqnarray}
\mathbf{A} \cdot \mathbf{A}&amp;=&amp;
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix} \cdot
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
a^2 + b \cdot d + c \cdot g &amp; a \cdot b + b \cdot e + c \cdot h &amp; a \cdot c + b \cdot f + c \cdot i\\
d \cdot a + e \cdot d + f \cdot g &amp; d \cdot b + e^2 + f \cdot h &amp; d \cdot c + e \cdot f + f \cdot i\\
g \cdot a + h \cdot d + i \cdot g &amp; g \cdot b + h \cdot e + i \cdot h &amp; g \cdot c + h \cdot f + i^2
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
27 &amp; 16 &amp; 44\\
56 &amp; 39 &amp; 28\\
11 &amp; 2 &amp; 68
\end{pmatrix}
\end{eqnarray}\]</span></p>
<p>This matrix multiplied with itself, <span class="math inline">\(\mathbf{A} \cdot \mathbf{A}\)</span>, is different to the same matrix multiplied with its transpose <span class="math inline">\(\mathbf{A} \cdot \mathbf{A}&#39;\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
\mathbf{A} \cdot \mathbf{A}&#39;&amp;=&amp;
\begin{pmatrix}
a &amp; b &amp; c\\
d &amp; e &amp; f\\
g &amp; h &amp; i
\end{pmatrix} \cdot
\begin{pmatrix}
a &amp; d &amp; g\\
b &amp; e &amp; h\\
c &amp; f &amp; i
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
a^2 + b^2 + c^2 &amp; a \cdot d + b \cdot e + c \cdot f &amp; a \cdot g + b \cdot h + c \cdot i\\
d \cdot a + e \cdot b + f \cdot c &amp; d^2 + e^2 + f^2 &amp; d \cdot g + e \cdot h + f \cdot i\\
g \cdot a + h \cdot b + i \cdot c &amp; g \cdot d + h \cdot e + i \cdot f &amp; g^2 + h^2 + i^2
\end{pmatrix}\\
&amp;=&amp;\begin{pmatrix}
29 &amp; 31 &amp; 35\\
31 &amp; 74 &amp; 7\\
35 &amp; 7 &amp; 65
\end{pmatrix}
\end{eqnarray}\]</span></p>
<p>This last matrix is symmetrical, i.e. mirrored along its diagonal. The diagonal elements here are so called <strong>sums of squares</strong>, off-diagonal elements are so called <strong>cross-products</strong>. This will be useful later on when working with variance-covariance matrices in Chapter <a href="08-multivariate.html#multivariate">7</a>.</p>
</div>
<div id="matrix-division-inverse-of-a-matrix-identity-matrix" class="section level3 hasAnchor" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Matrix division, inverse of a matrix, identity matrix<a href="02-math.html#matrix-division-inverse-of-a-matrix-identity-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Division of two matrices</strong> means multiplication of one matrix with the so called inverse of the other, here <span class="math inline">\(\mathbf{B}^{-1}\)</span>:</p>
<p><span class="math display">\[\frac{\mathbf{A}}{\mathbf{B}} = \mathbf{A} \cdot \mathbf{B}^{-1}\]</span></p>
<p>The <strong>inverse of a matrix</strong> is different to the transpose. It is rather complicated to calculate, using in most cases numerical (and not analytical) techniques that we do not go into here. At the most general level, the inverse is found so that the following equation holds:</p>
<p><span class="math display">\[\mathbf{A} \cdot \mathbf{A}^{-1} = \mathbf{A}^{-1} \cdot \mathbf{A} = \mathbf{I}\]</span></p>
<p>With <span class="math inline">\(\mathbf{I}\)</span> being the <strong>identity matrix</strong>, i.e. a matrix with diagonal elements 1 and off-diagonal elements 0:</p>
<p><span class="math display">\[\mathbf{I} =
\begin{pmatrix}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1
\end{pmatrix}
\]</span></p>
</div>
</div>
<div id="exercises" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Exercises<a href="02-math.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be done in class.</p>
<div id="exercise-1" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1<a href="02-math.html#exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Apply the rules in the script to the following equation to get rid of the product operator, and then simplify the resultant equation as much as you can:</p>
<p><span class="math display" id="eq:ex1">\[\begin{equation}
\prod_{i=1}^{n}\frac{1}{\sigma \cdot \sqrt{2 \cdot \pi}} \cdot \exp\left(\frac{\left(y_i - \beta_0 - \beta_1 \cdot x_i\right)^2}{-2 \cdot \sigma^2}\right)=
\tag{1.23}
\end{equation}\]</span></p>
</div>
<div id="exercise-2" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2<a href="02-math.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Apply the differentiation rules in the script to take the derivative of the following equation:</p>
<p><span class="math display" id="eq:ex2">\[\begin{equation}
\frac{d\sum_{i=1}^{n}\left(y_i - \beta_0 - \beta_1 \cdot x_i\right)^2}{d\beta_0}=
\tag{1.24}
\end{equation}\]</span></p>
</div>
<div id="exercise-3" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3<a href="02-math.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the following vectors and matrix: <span class="math inline">\(y =
\begin{pmatrix}
y_1\\
y_2\\
y_3
\end{pmatrix}\)</span>, <span class="math inline">\(\beta =
\begin{pmatrix}
\beta_0\\
\beta_1\\
\beta_2\\
\beta_3
\end{pmatrix}\)</span>, <span class="math inline">\(\epsilon =
\begin{pmatrix}
\epsilon_1\\
\epsilon_2\\
\epsilon_3
\end{pmatrix}\)</span> and <span class="math inline">\(\mathbf{X} =
\begin{pmatrix}
1 &amp; x_{11} &amp; x_{12} &amp; x_{13}\\
1 &amp; x_{21} &amp; x_{22} &amp; x_{23}\\
1 &amp; x_{31} &amp; x_{32} &amp; x_{33}
\end{pmatrix}\)</span>.</p>
<p>Now solve the following equation using matrix algebra:</p>
<p><span class="math display">\[y = \mathbf{X} \cdot \beta + \epsilon = \]</span></p>

</div>
</div>
</div>
<h3>References<a href="10-refs.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gelman2002" class="csl-entry">
Gelman, A., and D. Nolan. 2002. <em>Teaching Statistics: A Bag of Tricks</em>. New York: Oxford University Press.
</div>
<div id="ref-tabachnick2013" class="csl-entry">
Tabachnick, B. G., and L. S. Fidell. 2013. <em>Using Multivariate Statistics</em>. Boston: Pearson Education.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="03-lin_reg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
